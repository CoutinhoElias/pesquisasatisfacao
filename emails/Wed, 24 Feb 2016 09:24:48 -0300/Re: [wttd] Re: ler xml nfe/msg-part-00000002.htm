<div dir="ltr">Eu estou fazendo isso com o BeautifulSoup...<div><br></div><div><pre style="font-family:&#39;Source Code Pro&#39;"><span style="background-color:rgb(255,255,255)"><font color="#000000">soup = BeautifulSoup(arquivo_retorno.read(), &quot;xml&quot;)<br><span style="font-weight:bold">for </span>compnfse <span style="font-weight:bold">in </span>soup.findAll(&#39;CompNfse&#39;):</font></span></pre><pre style="font-family:&#39;Source Code Pro&#39;"><span style="color:rgb(0,0,0)">    nfse_numero = infnfse.Numero.string.strip()</span></pre><pre style="font-family:&#39;Source Code Pro&#39;"><span style="background-color:rgb(255,255,255)"><font color="#000000">    nfse_codigo_verificacao = infnfse.CodigoVerificacao.string.strip()</font></span></pre><pre style="font-family:&#39;Source Code Pro&#39;"><span style="background-color:rgb(255,255,255)"><font color="#000000">    nfse_data_emissao = infnfse.DataEmissao.string</font></span></pre><pre style="font-family:&#39;Source Code Pro&#39;"><span style="background-color:rgb(255,255,255)"><font color="#000000"><br></font></span></pre><pre style="font-family:&#39;Source Code Pro&#39;"><span style="background-color:rgb(255,255,255)"><font color="#000000">E por ai vai...</font></span></pre></div></div><div class="gmail_extra"><br><div class="gmail_quote">Em 24 de fevereiro de 2016 09:17, Thiago Oliveira <span dir="ltr">&lt;<a href="mailto:oliveiravicente.net@gmail.com" target="_blank">oliveiravicente.net@gmail.com</a>&gt;</span> escreveu:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">cara, eu to entendendo melhor a estrutura do xml e passo depois se quiser o código , com minidom tá mais fácil,<div>como Elementstree tava meio confuso e não deu pra chegar no resultado que gostaria , mas eu ainda que entender o </div><div>porque fica diferente , eu to precisando pega os valore da nota e produto e futuramente quero importar ela para meu sistema </div><div>mas é tudo estudo ainda... <br><div><br></div><div><br></div></div></div><div><div class="h5"><br><div class="gmail_quote"><div dir="ltr">Em ter, 23 de fev de 2016 às 18:45, Gustavo de Andrade &lt;<a href="mailto:gu_andrade1@yahoo.com.br" target="_blank">gu_andrade1@yahoo.com.br</a>&gt; escreveu:<br></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">Olá, Thiago!<br><br>Em breve vou precisar ver sobre isso também...<br>Há um tempo pesquisei um pouco e cheguei em resultados semelhantes aos seus. Também consegui algo mais com o <b>minidom</b>.<br>Olhei aqui nas minhas coisas e tenho o código que testei com Python 2, algo parecido com o que você conseguiu. Neste caso, com o item da nota (ela possui apenas um...) :<br><br><br>from xml.dom.minidom import parse<br>doc = parse(&#39;35140558551185000102550010000526571000526570-procNFe.xml&#39;)<br>xml = doc.documentElement<br>descricao = xml.getElementsByTagName(&#39;xProd&#39;)<br>print &#39;Descricao: %s&#39; % ( descricao[0].childNodes[0].data )<br><br><br>Não é bem o que você quer, mais você pode conseguir extrair as informações que você precisa com expressões regulares.<br>Utilizo elas com Shell Script (<b>grep</b> e <b>sed</b> =&gt; são demais! rs) para extrair o que preciso: CFOP, itens, alíquotas...<br>Eu vou por partes. Por exemplo, &quot;recorto&quot; o bloco do emitente, e depois corto o(s) pedaço(s) que quero.</div><div dir="ltr"><br><br><br>Em terça-feira, 23 de fevereiro de 2016 15:03:23 UTC-3, <a href="http://oliveiravicente.net" target="_blank">oliveiravicente.net</a>  escreveu:<blockquote class="gmail_quote" style="margin:0;margin-left:0.8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">galera, <div><br></div><div>to com uma dificuldade mas acho que é mais com o conceito, </div><div>to tentando ler um xml da nfe para compara alguns dados, </div><div>mas ta meio confuso, apesar de estar usando ElementTree que é <br></div><div>bem simples eu não esta conseguindo achar as tag pelo </div><div>EleentTree.find(&#39;vProd&#39;) por exemplo e sempre me retornava nulo, </div><div>ai resolvi imprimir o root do elemento pra ver como ficava e pra minha </div><div><br></div><div>código que deixei para o teste </div><div><br></div><div>document = open(r&#39;c:\28145.xml&#39;)<br></div><div><div>parsedXML = etree.parse(document)</div><div>root = parsedXML.getroot()</div><div>for node in root:</div><div>    print(node.tag)</div></div><div><br></div><div>para minha surpresa ele me mostra a tag assim </div><div><br></div><div>{<a href="http://www.portalfiscal.inf.br/nfe%7DNFe" target="_blank">http://www.portalfiscal.inf.br/nfe}NFe</a><br></div><div><div>{<a href="http://www.portalfiscal.inf.br/nfe%7DprotNFe" target="_blank">http://www.portalfiscal.inf.br/nfe}protNFe</a></div></div><div><br></div><div><br></div><div>então para que eu consiga acessar uma tag na nfe eu preciso usar </div><div>node.find(&#39;{<a href="http://www.portalfiscal.inf.br/nfe%7DNFe" target="_blank">http://www.portalfiscal.inf.br/nfe}NFe</a>&#39;) e ele me retorna </div><div>um elemento , mas se no xml a tag é NFe e o resto é um atributo xmlms , </div><div>isso vale para todas as tag...  </div><div> por exemplo para acessar o cfop eu preciso usar o </div><div><br></div><div>node.find({<a href="http://www.portalfiscal.inf.br/nfe%7DCFOP" target="_blank">http://www.portalfiscal.inf.br/nfe}CFOP</a>) <br></div><div>ai testei como minidom para ver se as era isso mesmo </div><div>e não consegui muito mas consegui ler o arquivo todos e </div><div>as tags estão certo</div><div><br></div><div>codigo exemplo do minidom  </div><div><div>xmldoc = minidom.parse(r&#39;c:\28145.xml&#39;)</div><div>listNodes =xmldoc.childNodes.item(0)</div><div>print(listNodes.nodeName)</div><div>print(&#39;--------------------------------------------------------------------&#39;)</div><div>print(listNodes.childNodes)</div><div><br></div><div><br></div><div>def for_nodes(nodesList):</div><div>    for child in nodesList.childNodes:</div><div>        if child.nodeType == Node.ELEMENT_NODE:</div><div>            print(child.parentNode.nodeName, child.nodeName)</div><div>            if child.hasChildNodes():</div><div>                print(child.nodeName, &#39;=&#39;, child.firstChild.nodeValue)</div><div>                if child.hasAttributes():</div><div>                    print(&#39;Nome Atributo&#39;, child.attributes.item(0).name,</div><div>                          &#39;valor Atributo&#39;, child.attributes.item(0).value)</div><div>        for_nodes(child)</div><div>for_nodes(listNodes)</div></div><div><br></div><div>nesse caso ele me tras os nomes certos se usar o </div><div><br></div><div>getElementsByName(&#39;CFOP&#39;) ele me retorno o elemento, mas to achando o mimidom meio complicado, oque vc indicam para ler xml </div><div>da NFe ?</div><div><br></div><div><br></div><div>alguém ja fez isso, tem algum exemplo ou um tutorial bacana para entender melhor com funciona para ler XML ? </div><div><br></div><div><br></div></div><div dir="ltr">-- <br></div><div dir="ltr"><div>Obrigado.</div>Thiago Oliveira Vicente <div>cel: 11-97051-3508</div></div>
</blockquote></div>

<p></p>

-- <br>
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br>
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com" target="_blank">wttd-2015+unsubscribe@googlegroups.com</a>.<br>
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com" target="_blank">wttd-2015@googlegroups.com</a>.<br>
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015" target="_blank">https://groups.google.com/group/wttd-2015</a>.<br>
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/bfb7f28a-fa84-47ec-894d-5a262f1ea203%40googlegroups.com?utm_medium=email&amp;utm_source=footer" target="_blank">https://groups.google.com/d/msgid/wttd-2015/bfb7f28a-fa84-47ec-894d-5a262f1ea203%40googlegroups.com</a>.<br>
Para mais opções, acesse <a href="https://groups.google.com/d/optout" target="_blank">https://groups.google.com/d/optout</a>.<br>
</blockquote></div><div dir="ltr">-- <br></div><div dir="ltr"><div>Obrigado.</div>Thiago Oliveira Vicente <div>cel: 11-97051-3508</div></div>

<p></p>

-- <br>
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br>
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com" target="_blank">wttd-2015+unsubscribe@googlegroups.com</a>.<br>
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com" target="_blank">wttd-2015@googlegroups.com</a>.<br>
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015" target="_blank">https://groups.google.com/group/wttd-2015</a>.<br></div></div>
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/CADfz%3Dw_Ge8CBkeKJ1Q0fvGDDZP2UTU6BvZ6%3Db%3DTiWXVT1LDaeQ%40mail.gmail.com?utm_medium=email&amp;utm_source=footer" target="_blank">https://groups.google.com/d/msgid/wttd-2015/CADfz%3Dw_Ge8CBkeKJ1Q0fvGDDZP2UTU6BvZ6%3Db%3DTiWXVT1LDaeQ%40mail.gmail.com</a>.<div class="HOEnZb"><div class="h5"><br>
Para mais opções, acesse <a href="https://groups.google.com/d/optout" target="_blank">https://groups.google.com/d/optout</a>.<br>
</div></div></blockquote></div><br></div>

<p></p>

-- <br />
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br />
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com">wttd-2015+unsubscribe@googlegroups.com</a>.<br />
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com">wttd-2015@googlegroups.com</a>.<br />
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015">https://groups.google.com/group/wttd-2015</a>.<br />
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/CABFyQW_68e2e4aJzZ0Vimx-O8PvOnWzRwRx6%3DdSbjMNJPGnxSA%40mail.gmail.com?utm_medium=email&utm_source=footer">https://groups.google.com/d/msgid/wttd-2015/CABFyQW_68e2e4aJzZ0Vimx-O8PvOnWzRwRx6%3DdSbjMNJPGnxSA%40mail.gmail.com</a>.<br />
Para mais opções, acesse <a href="https://groups.google.com/d/optout">https://groups.google.com/d/optout</a>.<br />
