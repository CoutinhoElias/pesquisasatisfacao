<div dir="ltr"><div>Pessoal dêem uma olhada nisso aqui:</div><div><br></div><div><a href="https://github.com/rg3915/orcamentos/issues/53">https://github.com/rg3915/orcamentos/issues/53</a></div><div><br></div><div>Eu fiz um gráfico usando Morris JS</div><div><br></div><div><a href="https://github.com/rg3915/orcamentos/blob/master/img/graphic.png">https://github.com/rg3915/orcamentos/blob/master/img/graphic.png</a></div><div><br></div><div><img src="https://raw.githubusercontent.com/rg3915/orcamentos/master/img/graphic.png" width="469" height="261"><br><br></div><div><br></div><div><b>Pergunta: como eu faço para retornar get_status_display no json?</b></div><div><br></div><div><font face="monospace, monospace">import json</font></div><div><font face="monospace, monospace">from django.db.models import Count</font></div><div><font face="monospace, monospace">from django.core.serializers.json import DjangoJSONEncoder</font></div><div><font face="monospace, monospace">from django.http import HttpResponse</font></div><div><font face="monospace, monospace">from .models import Proposal</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">def proposal_per_status_json(request):</font></div><div><font face="monospace, monospace">    &#39;&#39;&#39; Quantidade de orçamentos por status &#39;&#39;&#39;</font></div><div><font face="monospace, monospace">    data = Proposal.objects.values(&#39;status&#39;)\</font></div><div><font face="monospace, monospace">        .annotate(value=Count(&#39;status&#39;))\</font></div><div><font face="monospace, monospace">        .order_by(&#39;status&#39;).values(&#39;status&#39;, &#39;value&#39;)</font></div><div><font face="monospace, monospace">    &#39;&#39;&#39;</font></div><div><font face="monospace, monospace">    Precisa reescrever o dicionário com os campos do gráfico,</font></div><div><font face="monospace, monospace">    que são: &#39;label&#39; e &#39;value&#39;.</font></div><div><font face="monospace, monospace">    &#39;&#39;&#39;</font></div><div><font face="monospace, monospace">    data = [{&#39;label&#39;: x[&#39;status&#39;], &#39;value&#39;:x[&#39;value&#39;]} for x in data]</font></div><div><font face="monospace, monospace">    s = json.dumps(list(data), cls=DjangoJSONEncoder)</font></div><div><font face="monospace, monospace">    return HttpResponse(s)</font></div><div><br></div><div><br></div><div><a href="http://localhost:8000/proposal/proposal/proposal_per_status_json/">http://localhost:8000/proposal/proposal/proposal_per_status_json/</a></div><div><br></div><div><font face="monospace, monospace">[{&quot;label&quot;: &quot;a&quot;, &quot;value&quot;: 11}, {&quot;label&quot;: &quot;c&quot;, &quot;value&quot;: 9}, {&quot;label&quot;: &quot;co&quot;, &quot;value&quot;: 28}, {&quot;label&quot;: &quot;elab&quot;, &quot;value&quot;: 9}, {&quot;label&quot;: &quot;p&quot;, &quot;value&quot;: 14}]</font></div><div><br></div><div>Mas eu queria</div><div><br></div><div><font face="monospace, monospace">[{&quot;label&quot;: &quot;aprovado&quot;, &quot;value&quot;: 11}, {&quot;label&quot;: &quot;cancelado&quot;, &quot;value&quot;: 9}, {&quot;label&quot;: &quot;concluído&quot;, &quot;value&quot;: 28}, {&quot;label&quot;: &quot;em elaboração&quot;, &quot;value&quot;: 9}, {&quot;label&quot;: &quot;pendente&quot;, &quot;value&quot;: 14}]</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">STATUS_FILTER = (</font></div><div><font face="monospace, monospace">    (&#39;c&#39;, &#39;cancelado&#39;),</font></div><div><font face="monospace, monospace">    (&#39;elab&#39;, &#39;em elaboração&#39;),</font></div><div><font face="monospace, monospace">    (&#39;p&#39;, &#39;pendente&#39;),</font></div><div><font face="monospace, monospace">    (&#39;co&#39;, &#39;concluido&#39;),</font></div><div><font face="monospace, monospace">    (&#39;a&#39;, &#39;aprovado&#39;)</font></div><div><font face="monospace, monospace">)</font></div><div><div class="gmail_signature"><div dir="ltr"><table border="0" cellpadding="0" width="180" style="font-family:&#39;Times New Roman&#39;;table-layout:fixed"><tbody><tr><td align="left" nowrap width="100"><p style="font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:12px;color:rgb(33,33,33);margin-bottom:10px"><span style="font-weight:bold;display:inline">Regis da Silva</span><br><span style="display:inline"></span><span style="display:inline">Web Developer</span><br></p><p style="font-size:0px;line-height:0;font-family:Helvetica,Arial,sans-serif"><a href="http://rg3915.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/rg3915/rg3915.github.io/master/img/paper_plane_gray.png" alt="Aboutme" style="margin-bottom: 2px; border: none; display: inline;"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="http://grandeportal.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/grandeportal/grandeportal.github.io/master/images/matrix-icon.jpg" alt="matrix" style="margin-bottom: 2px; border: none; display: inline;"></a><span style="white-space:nowrap"></span> <a href="https://about.me/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="http://www.kevinpiersoul.com/assets/images/about-active.png" alt="Aboutme" style="margin-bottom: 2px; border: none; display: inline;"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://www.linkedin.com/profile/public-profile-settings?trk=prof-edit-edit-public_profile" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/linkedin.png" alt="Linkedin" style="margin-bottom: 2px; border: none; display: inline;"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://github.com/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/github.png" alt="github" style="margin-bottom: 2px; border: none; display: inline;"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span></p></td></tr></tbody></table></div></div></div>
</div>

<p></p>

-- <br />
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br />
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com">wttd-2015+unsubscribe@googlegroups.com</a>.<br />
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com">wttd-2015@googlegroups.com</a>.<br />
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015">https://groups.google.com/group/wttd-2015</a>.<br />
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/CA%2BDznZN_FHc7BBFVi%3DbwyENgO%2BJGz_mLzs9AzPV_4pOeDw8%2BfA%40mail.gmail.com?utm_medium=email&utm_source=footer">https://groups.google.com/d/msgid/wttd-2015/CA%2BDznZN_FHc7BBFVi%3DbwyENgO%2BJGz_mLzs9AzPV_4pOeDw8%2BfA%40mail.gmail.com</a>.<br />
Para mais opções, acesse <a href="https://groups.google.com/d/optout">https://groups.google.com/d/optout</a>.<br />
