<div dir="ltr"><font face="monospace, monospace"><span style="font-size:12.8px">vai ser algo como isto:<br><br><br>admin.py:<br></span></font><div><pre style="color:rgb(169,183,198);font-family:&#39;Source Code Pro&#39;;background-color:rgb(43,43,43)">@<span style="color:rgb(187,181,41)">admin.register</span>(Employee)<br><span style="color:rgb(204,120,50);font-weight:bold">class </span><span style="font-weight:bold">EmployeeAdmin</span>(PersonAdmin):<br>    objects = EmployeeManager()<br><br>     <br>    <span style="color:rgb(128,128,128)">#class Meta:  # nao me lembro se proxy aqui eh necessario<br></span><span style="color:rgb(128,128,128)">    #    proxy = True<br></span><span style="color:rgb(128,128,128)"><br></span><span style="color:rgb(128,128,128)">    </span><span style="color:rgb(204,120,50);font-weight:bold">def </span><span style="font-weight:bold">save_model</span>(<span style="color:rgb(148,85,141)">self</span><span style="color:rgb(204,120,50)">, </span>request<span style="color:rgb(204,120,50)">, </span>obj<span style="color:rgb(204,120,50)">, </span>form<span style="color:rgb(204,120,50)">, </span>change):<br>        obj.person_type = <span style="color:rgb(0,128,128)">&#39;p&#39;<br></span><span style="color:rgb(0,128,128)">        </span><span style="color:rgb(136,136,198)">super</span>(EmployeeAdmin<span style="color:rgb(204,120,50)">, </span><span style="color:rgb(148,85,141)">self</span>).save_model(request<span style="color:rgb(204,120,50)">, </span>obj<span style="color:rgb(204,120,50)">, </span>form<span style="color:rgb(204,120,50)">, </span>change)<br></pre></div><div><br></div><div><br></div><font face="monospace, monospace"><span style="font-size:12.8px"><br></span></font></div><div class="gmail_extra"><br><div class="gmail_quote">2016-03-11 12:07 GMT-03:00 Régis Silva <span dir="ltr">&lt;<a href="mailto:regis.santos.100@gmail.com" target="_blank">regis.santos.100@gmail.com</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>Pessoal, estou experimentando usar o proxy models a partir do site</div><div><br></div><div><a href="http://benlopatin.com/using-django-proxy-models/" target="_blank">http://benlopatin.com/using-django-proxy-models/</a></div><div><br></div><div>Vejam como ficou meu código:</div><div><br></div><div><a href="https://github.com/rg3915/temp" target="_blank">https://github.com/rg3915/temp</a></div><div><br></div><div>Vamos recapitular:</div><div><br></div><div>Eu preciso de um Employee, que no caso provém de Person.</div><div>Eu só tenho a tabela Person (e não quero criar outra).</div><div>Dai eu inseri um campo</div><div><br></div><div><font face="monospace, monospace">#models.py</font></div><div><font face="monospace, monospace">PERSON_TYPE = (</font></div><div><font face="monospace, monospace">    (&#39;p&#39;, &#39;person&#39;),</font></div><div><font face="monospace, monospace">    (&#39;e&#39;, &#39;employee&#39;),</font></div><div><font face="monospace, monospace">)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class Person(TimeStampedModel, Address):</font></div><span class=""><div><font face="monospace, monospace">    first_name = models.CharField(&#39;nome&#39;, max_length=50)</font></div><div><font face="monospace, monospace">    last_name = models.CharField(&#39;sobrenome&#39;, max_length=50, null=True, blank=True)</font></div><div><font face="monospace, monospace">    email = models.EmailField(null=True, blank=True)</font></div></span><div><font face="monospace, monospace">    person_type = models.CharField(&#39;tipo&#39;, max_length=1, choices=PERSON_TYPE, default=&#39;p&#39;)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class Employee(Person):</font></div><div><font face="monospace, monospace">    objects = EmployeeManager()</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    class Meta:</font></div><div><font face="monospace, monospace">        proxy = True</font></div><div><font face="monospace, monospace">        verbose_name = &#39;funcionário&#39;</font></div><div><font face="monospace, monospace">        verbose_name_plural = &#39;funcionários&#39;</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">#managers.py</font></div><div><font face="monospace, monospace">from django.db import models</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class EmployeeManager(models.Manager):</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    def get_queryset(self):</font></div><div><font face="monospace, monospace">        return super(EmployeeManager, self).get_queryset().filter(person_type=&#39;c&#39;)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">#admin.py</font></div><div><font face="monospace, monospace">from daterange_filter.filter import DateRangeFilter</font></div><div><font face="monospace, monospace">from django.contrib import admin</font></div><div><font face="monospace, monospace">from .models import Person, Phone, Employee</font></div><div><font face="monospace, monospace">from .forms import PersonForm</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class PhoneInline(admin.TabularInline):</font></div><div><font face="monospace, monospace">    model = Phone</font></div><div><font face="monospace, monospace">    extra = 1</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">@admin.register(Person)</font></div><div><font face="monospace, monospace">class PersonAdmin(admin.ModelAdmin):</font></div><div><font face="monospace, monospace">    inlines = [PhoneInline]</font></div><div><font face="monospace, monospace">    list_display = (&#39;__str__&#39;, &#39;email&#39;, &#39;phone&#39;, &#39;uf&#39;, &#39;created&#39;, &#39;blocked&#39;)</font></div><div><font face="monospace, monospace">    date_hierarchy = &#39;created&#39;</font></div><div><font face="monospace, monospace">    search_fields = (&#39;first_name&#39;, &#39;last_name&#39;, &#39;email&#39;)</font></div><div><font face="monospace, monospace">    list_filter = (</font></div><div><font face="monospace, monospace">        # &#39;uf&#39;,</font></div><div><font face="monospace, monospace">        (&#39;created&#39;, DateRangeFilter),</font></div><div><font face="monospace, monospace">    )</font></div><div><font face="monospace, monospace">    form = PersonForm</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    def phone(self, obj):</font></div><div><font face="monospace, monospace">        return obj.phone_set.first()</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    phone.short_description = &#39;telefone&#39;</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">admin.site.register(Employee)</font></div><div><br></div><div><br></div><div><b>Problema: </b>Quando eu salvo o Funcionário (Employee) ele deveria ficar na lista de funcionário, mas não fica.</div><div>Como eu faço para deixá-lo na lista do Admin?</div><div><br></div><div>E ainda, quando eu criar um employee_form.html, como eu faço para que ele salve no Funcionário e que seja person_type = &#39;e&#39; por default, tanto no form quanto nas listas?</div></div><div class="gmail_extra"><span class=""><br clear="all"><div><div><div dir="ltr"><table border="0" cellpadding="0" width="180" style="font-family:&#39;Times New Roman&#39;;table-layout:fixed"><tbody><tr><td align="left" nowrap width="100"><p style="font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:12px;color:rgb(33,33,33);margin-bottom:10px"><span style="font-weight:bold;display:inline">Regis da Silva</span><br><span style="display:inline"></span><span style="display:inline">Web Developer</span><br></p><p style="font-size:0px;line-height:0;font-family:Helvetica,Arial,sans-serif"><a href="http://rg3915.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/rg3915/rg3915.github.io/master/img/paper_plane_gray.png" alt="Aboutme" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="http://grandeportal.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/grandeportal/grandeportal.github.io/master/images/matrix-icon.jpg" alt="matrix" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"></span> <a href="https://about.me/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="http://www.kevinpiersoul.com/assets/images/about-active.png" alt="Aboutme" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://www.linkedin.com/profile/public-profile-settings?trk=prof-edit-edit-public_profile" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/linkedin.png" alt="Linkedin" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://github.com/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/github.png" alt="github" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span></p></td></tr></tbody></table></div></div></div>
<br></span><div><div class="h5"><div class="gmail_quote">2016-03-09 20:29 GMT-03:00 Régis Silva <span dir="ltr">&lt;<a href="mailto:regis.santos.100@gmail.com" target="_blank">regis.santos.100@gmail.com</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>Não sei se o título ficou bom mas é o seguinte:</div><div><br></div><div>Eu tenho uma classe Person.</div><div><br></div><div><font face="monospace, monospace"># models.py</font></div><div><font face="monospace, monospace">PERSON_TYPE = (</font></div><div><font face="monospace, monospace">    (&#39;c&#39;, &#39;cliente&#39;),</font></div><div><font face="monospace, monospace">    (&#39;p&#39;, &#39;contato&#39;),</font></div><div><font face="monospace, monospace">)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class Person(People):</font></div><div><font face="monospace, monospace">    first_name = models.CharField(&#39;nome&#39;, max_length=50)</font></div><div><font face="monospace, monospace">    last_name = models.CharField(&#39;sobrenome&#39;, max_length=50, null=True, blank=True)</font></div><div><font face="monospace, monospace">    email = models.EmailField(null=True, blank=True)</font></div><div><font face="monospace, monospace">    person_type = models.CharField(&#39;cliente ou contato&#39;, max_length=1, choices=PERSON_TYPE)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    objects = CustomerManager()</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    class Meta:</font></div><div><font face="monospace, monospace">        ordering = [&#39;first_name&#39;]</font></div><div><font face="monospace, monospace">        verbose_name = &#39;contato&#39;</font></div><div><font face="monospace, monospace">        verbose_name_plural = &#39;contatos&#39;</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"># managers.py</font></div><div><font face="monospace, monospace">from django.db import models</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">class CustomerQuerySet(models.Manager):</font></div><div><font face="monospace, monospace">    &#39;&#39;&#39; Customer is person_type = c by CUSTOMER_TYPE choices &#39;&#39;&#39;</font></div><div><font face="monospace, monospace">    PERSON_TYPE = &#39;c&#39;</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">    def customer(self):</font></div><div><font face="monospace, monospace">        return self.filter(person_type=self.PERSON_TYPE)</font></div><div><font face="monospace, monospace"><br></font></div><div><font face="monospace, monospace">CustomerManager = models.Manager.from_queryset(CustomerQuerySet)</font></div><div><br></div><div>Ou seja, eu queria criar um Customer como se fosse outra tabela, ou outro objeto.</div><div>Eu quero tratar o Customer para eu fazer todas as interações como se fosse uma tabela real, mesmo sendo a mesma de Person. É possível? É este o caminho? Ou seja, o managers está correto?</div><div><br></div><div>Depois eu queria criar</div><div><br></div><div>templates/customer_list.html</div><div>templates/customer_detail.html</div><div>templates/customer_form.html</div><div><br></div><div>Como de costume.</div><div><br></div><div><div><div dir="ltr"><table border="0" cellpadding="0" width="180" style="font-family:&#39;Times New Roman&#39;;table-layout:fixed"><tbody><tr><td align="left" nowrap width="100"><p style="font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:12px;color:rgb(33,33,33);margin-bottom:10px"><span style="font-weight:bold;display:inline">Regis da Silva</span><br><span style="display:inline"></span><span style="display:inline">Web Developer</span><br></p><p style="font-size:0px;line-height:0;font-family:Helvetica,Arial,sans-serif"><a href="http://rg3915.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/rg3915/rg3915.github.io/master/img/paper_plane_gray.png" alt="Aboutme" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="http://grandeportal.github.io/" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://raw.githubusercontent.com/grandeportal/grandeportal.github.io/master/images/matrix-icon.jpg" alt="matrix" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"></span> <a href="https://about.me/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="http://www.kevinpiersoul.com/assets/images/about-active.png" alt="Aboutme" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://www.linkedin.com/profile/public-profile-settings?trk=prof-edit-edit-public_profile" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/linkedin.png" alt="Linkedin" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span> <a href="https://github.com/rg3915" style="display:inline;text-decoration:none" target="_blank"><img width="16" height="16" src="https://s3.amazonaws.com/htmlsig-assets/round/github.png" alt="github" style="margin-bottom:2px;border:none;display:inline"></a><span style="white-space:nowrap"><img src="https://s3.amazonaws.com/htmlsig-assets/spacer.gif" width="2"></span></p></td></tr></tbody></table></div></div></div>
</div>
</blockquote></div><br></div></div></div><div><div class="h5">

<p></p>

-- <br>
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br>
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com" target="_blank">wttd-2015+unsubscribe@googlegroups.com</a>.<br>
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com" target="_blank">wttd-2015@googlegroups.com</a>.<br>
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015" target="_blank">https://groups.google.com/group/wttd-2015</a>.<br></div></div>
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/CA%2BDznZPymG2-bmRYdf5-T9-ZEu_-DwJ41CtkZmXFP%3DRpyRpvMg%40mail.gmail.com?utm_medium=email&amp;utm_source=footer" target="_blank">https://groups.google.com/d/msgid/wttd-2015/CA%2BDznZPymG2-bmRYdf5-T9-ZEu_-DwJ41CtkZmXFP%3DRpyRpvMg%40mail.gmail.com</a>.<div class="HOEnZb"><div class="h5"><br>
Para mais opções, acesse <a href="https://groups.google.com/d/optout" target="_blank">https://groups.google.com/d/optout</a>.<br>
</div></div></blockquote></div><br><br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><div dir="ltr"><div dir="ltr" style="font-family:arial;font-size:small">Fábio C. Barrionuevo da Luz<br>Palmas - Tocantins - Brasil - América do Sul<br><div><br></div><div><a href="http://pythonclub.com.br/" style="color:rgb(17,85,204)" target="_blank">http://pythonclub.com.br/</a></div><div><br></div><div><div>Blog colaborativo sobre Python e tecnologias Relacionadas, mantido totalmente no <a href="https://github.com/pythonclub/pythonclub.github.io" style="color:rgb(17,85,204)" target="_blank">https://github.com/pythonclub/pythonclub.github.io</a> .</div><div><br></div><div>Todos são livres para publicar. É só fazer fork, escrever sua postagem e mandar o pull-request. Leia mais sobre como publicar em README.md e <a href="http://contributing.md/" style="color:rgb(17,85,204)" target="_blank">contributing.md</a>.</div><div>Regra básica de postagem:</div><div>&quot;Você&quot; acha interessante? É útil para &quot;você&quot;? Pode ser utilizado com Python ou é útil para quem usa Python? Está esperando o que? Publica logo, que estou louco para ler...</div></div></div><div><div style="font-family:arial;font-size:small"><div><br></div></div></div></div></div></div></div>
</div>

<p></p>

-- <br />
Você recebeu essa mensagem porque está inscrito no grupo &quot;Welcome to the Django 2015&quot; dos Grupos do Google.<br />
Para cancelar inscrição nesse grupo e parar de receber e-mails dele, envie um e-mail para <a href="mailto:wttd-2015+unsubscribe@googlegroups.com">wttd-2015+unsubscribe@googlegroups.com</a>.<br />
Para postar nesse grupo, envie um e-mail para <a href="mailto:wttd-2015@googlegroups.com">wttd-2015@googlegroups.com</a>.<br />
Acesse esse grupo em <a href="https://groups.google.com/group/wttd-2015">https://groups.google.com/group/wttd-2015</a>.<br />
Para ver essa discussão na Web, acesse <a href="https://groups.google.com/d/msgid/wttd-2015/CAPVjvMY-KE4BMBo7%3DN5VV1yMiws0Eucu1rNDu1LoNnhWSzuvmw%40mail.gmail.com?utm_medium=email&utm_source=footer">https://groups.google.com/d/msgid/wttd-2015/CAPVjvMY-KE4BMBo7%3DN5VV1yMiws0Eucu1rNDu1LoNnhWSzuvmw%40mail.gmail.com</a>.<br />
Para mais opções, acesse <a href="https://groups.google.com/d/optout">https://groups.google.com/d/optout</a>.<br />
